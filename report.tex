\documentclass[a4paper, 11pt]{report}
\usepackage{preamble}

\begin{document}\maketitle

\tableofcontents

\chapter{Introduction}


\chapter{Representations and Hall algebras of cyclic quivers}

In this chapter we will review some of the relevant background on quiver representations and establish notation and terminology. The cases of linear quivers of type $A$ and cyclic quivers (type $\tilde{A}$) will be considered in detail. In particular, the aim is to describe the classification of finite dimensional representations of a cyclic quiver over $\complex$; or over an arbitrary field. In the case of an arbitrary field, there is a combinatorial characterisation of the isomorphism classes of nilpotent representations, which does not depend on the ground field. This fact is used in defining the Ringel-Hall algebra of a cyclic quiver. (!!) The subalgebra generated by the isoclasses of simple representations, called the composition subalgebra, gives a realisation of the positive part of the quantised enveloping algebra $U_q(\tilde{\mathfrak{gl}_n})$.

References for this chapter include: \cite{hubery04}, \cite{hubery07}, \cite{deng15}.

{\color{gray}
Give the basic definitions and results for an arbitrary connected quiver:

define representations of a quiver, morphisms of quiver representations, simple representations. Define the path algebra of the quiver and give notation for orthogonal idempotents corresponding to the vertices. Emphasise the equivalence between representations of the quiver and modules over the path algebra.

The category of finite dimensional representations of a quiver is Krull-Schmidt, abelian, and so on.

Give Gabriel's theorem and the generalisation due to Kac-(?).

Illustrative example(s): Ringel-Hall algebras for type $A_2$ and $A_3$ of different orientations.}

\section{Cyclic quivers}

Let $n$ be a positive integer. Let $\cyclic = (\cyclic_0,\cyclic_1)$ denote the (cyclic) quiver with vertex set $\cyclic_0 = \integers/{n\integers}$ and arrows $\cyclic_1 = \{i\to i+1: i \in\cyclic_0\}$.

Let $\field$ be a field. A representation $V=(V_i,\rho_i)_{i\in\cyclic_0}$ of $\cyclic$ over $\field$ is a collection of vector spaces $V_i:i\in\cyclic_0$ and linear maps $\rho_i\colon V_i\to V_{i+1}$ for $i\in\cyclic_0$. A morphism $f\colon V\to W$ is a collection of linear maps $f_i\colon V_i\to W_i$ ($i\in\cyclic_0$) such that $\rho^W_i f_i = f_{i+1}\rho^V_i$ for $i\in\cyclic_0$.

The category of finite dimensional representations of $\cyclic$ over $\field$, denoted $rep_\field(\cyclic)$, is abelian and Krull-Schmidt. $rep_\field(\cyclic)$ is equivalent to the category of finite dimensional left modules over the path algebra $\field\cyclic$, denoted $mod(\field\cyclic)$.

The dimension vector of a finite dimensional representation $M$ is $\underline{\dim}(M) = (\dim(M_1),\ldots,\dim(M_n))\in\integers^n$.
{\color{orange} Give consequence of Gabriel's theorem in this case. Discussion of real and imaginary roots. roughly -- real roots ($q(\alpha)=1$): there is a unique indecomposable with dimension vector $\alpha$, up to isomorphism; imaginary roots ($q(\alpha)=0$): a family of isoclasses of indecomposables indexed by $\mathbb{P}^1_k$?.}

$M\in mod(\field\cyclic)$ is nilpotent if there is $a>0$ such that $(\field\cyclic)^a\cdot M = 0$. The nilpotent modules constitute a full abelian subcategory of $mod(\field\cyclic)$, which we denote by $mod^0(\field\cyclic)$. The subcategory of nilpotent representations corresponds to the inhomogeneous tube of rank $n$, with quasi-simples corresponding to the 1-dimensional simple representations at each vertex. In particular, the set of isoclasses in $mod^0(\field\cyclic)$ has a combinatorial description which does not depend on the underlying field.

For $i\in\cyclic_0$, let $S_i$ denote the simple module $S_i = \field e_i$, where $e_i$ acts as $1$ and all other paths act as $0$. The indecomposable modules are uniserial and admit a composition series with composition factors (amongst) $S_1,\ldots,S_n$ -- see this by taking the radical filtration of an indecomposable nilpotent module.

Up to isomorphism, there is a unique module with top $S_i$ and length $l\geq 1$, which we denote by $S_i(l)$. By convention, set $S_i(0) = 0$. Then we have non-split short exact sequences
\begin{equation*}
S_{i+1}(l-1)\to S_i(l)\to S_i
\end{equation*}

\begin{equation*}
S_{i+l-1}\to S_i(l)\to S_i(l-1),
\end{equation*}
given by embedding of the radical and the quotient by the socle, respectively. In light of these, the convention $S_i(0)=0$ reflects that simple modules have length $1$, so $S_i(1)=S_i$.

\begin{lemma}[extensions of strings]
Let $i_1,i_2\in\cyclic_0$ and $l_1,l_2\geq 1$. $Ext^1(S_{i_2}(l_2), S_{i_1}(l_1))=0$ unless $i_2 = i_1 + j_1$. In the case $i_2 = i_1 + l_1$, we have
\begin{equation*}
\dim Ext^1(S_{i_2}(l_2), S_{i_1}(l_1)) = 1.
\end{equation*}
The class of the non-split extension is given by the short exact sequence
\begin{equation*}
S_{i_1 + l_1}(l_2)\to S_{i_1}(l_1+ l_2) \to S_{i_1}(l_1).
\end{equation*}
\end{lemma}

\begin{lemma}[structure theorem]
Any $M\in\mod^0(\field\cyclic)$ decomposes uniquely as
\begin{equation*}
M\cong \bigoplus_{i\in\cyclic_0; l\geq 1} m_{i,l}S_i(l)
\end{equation*}
\end{lemma}

\section{Hall algebras: finite fields}

We now define the Hall algebra of $mod(\field\cyclic)$, where $\field$ is a finite field with $\mathrm{q} = \#\field$ elements:
Let $\mathcal{H}(\field\cyclic)$ be a free $\integers$-module with basis $Iso(\field\cyclic)$ with a $\integers$-bilinear pairing given by
\begin{equation*}
[M][N] = \sum_{[L]\in Iso(\field\cyclic)} \phi_{[M],[N]}^{[L]} [L],
\end{equation*}
where
\begin{equation*}
\phi_{[M],[N];\mathrm{q}}^{[L]} = \#\{X\le L: X\cong N, L/X\cong M\}.
\end{equation*}
This is well defined, since the cardinality of the set on the right hand side does not depend on the choice of representatives $M,N,L$ of the isomorphism classes. These cardinalities are finite since $L,M,N$ are finite dimensional and $\field$ is a finite field. With this choice of bilinear pairing, $\mathcal{H}(\field\cyclic)$ is a ring with $1 = [0]$, which is known as the Hall algebra of $\field\cyclic$. The isomorphism classes of nilpotent representations span a subalgebra of $\mathcal{H}(\field\cyclic)$, which may be seen as the Hall algebra of the category $mod^0(\field\cyclic)$ of finite dimensional nilpotent $\field\cyclic$-modules.

\section{The Ringel-Hall algebra of a cyclic quiver}

In order to define the Ringel-Hall algebra, we first give a combinatorial description of the set of isomorphism classes of finite-dimensional nilpotent $\field\cyclic$-modules, where $\field$ is any field. If $M\in mod^0(\field\cyclic)$, then
\begin{equation*}
M\cong\bigoplus_{i\in\cyclic_0, l\geq 1} m_{i,l}S_i(l),
\end{equation*}
for some $m_{i,l}\in\naturals$. Associate to $M$ the collection $((l_{1,1},\ldots, l_{1,m_1}),\ldots ,(l_{n,1},\ldots,l_{n,m_n}))$, which may be arranged as an upper triangular tableaux -- for now I want to avoid confusion with the matrices indexing orbits in $\dblflags$.

There exist polynomials $h_{M,N}^L\in\integers[q]$, for each $L,M,N\in Iso(\complex\cyclic)$, such that
\begin{equation*}
h_{M,N}^L(\mathrm{q}) = \phi_{[M],[N];\mathrm{q}}^{[L]}
\end{equation*}

The generic Ringel Hall algebra of $\cyclic$ is defined as follows: Let $\mathcal{H}(\cyclic)$ be a free $\integers[q]$-module with basis $Iso^0(\complex\cyclic)$, consisting of the isomorphism classes of finite dimensional nilpotent $\complex\cyclic$-modules, with $\integers[q]$ bilinear pairing given by
\begin{equation*}
[M][N] = \sum_{[L]\in Iso(\complex\cyclic)} h_{M,N}^L [L]
\end{equation*}

Then $\mathcal{H}(\cyclic)$ is an associative $\integers[q]$-algebra with multiplicative identity $1 = [0]$. A short note on this construction: Proving existence of these polynomial structure constants is hard, however their uniqueness is clear and associativity of the multiplication follows from associativity of the multiplication in $\mathcal{H}(\field\cyclic)$.

If $\field$ is a finite field with $\mathrm{q}$ elements, then the specialisation of $\mathcal{H}(\cyclic)$ at $q=\mathrm{q}$ is isomorphic to the Hall algebra of nilpotent $\field\cyclic$-modules:
\begin{equation*}
\integers[q]/{(q-\mathrm{q})}\otimes_{\integers[q]} \mathcal{H}(\cyclic) \cong \mathcal{H}(mod^0(\field\cyclic))
\end{equation*}

The 0-Hall algebra of $\cyclic$ is the specialisation of $\mathcal{H}(\cyclic)$ at $q=0$:
\begin{equation*}
\mathcal{H}_0(\cyclic) \coloneqq \integers[q]/{(q)}\otimes_{\integers[q]} \mathcal{H}(\cyclic)
\end{equation*}


\chapter{The cyclic flags approach to affine q-Schur algebras.}

\section{Cyclic flags}

Fix $n,r\in\naturals$. Let $\field$ be a field and write $\polys = \field[\epsilon]$ and $\laurent = \field[\epsilon,\epsilon^{-1}]$. Let $V$ be a free $\laurent$-module of rank $r$ and let $G$ denote the automorphism group of $V$.

A lattice in $V$ is a $\polys$-submodule $L$ of $V$ with $\laurent\otimes_\polys L = V$. In particular, a lattice is a rank $r$ free $\polys$-module with $L\subset V$. The space of cyclic flags in $V$ is
\begin{equation*}
\flags = \{L=(L_i)_{i\in\integers}:L_i\subset L_{i+1}, \epsilon L_i = L_{i-n}\text{ for } i\in\integers\}
\end{equation*}

$G$ acts on $\flags$ by the natural $G$-action on $V$: $(g.L)_i = g(L_i)$ for each $i\in\integers$. There is a bijection between the set of $G$-orbits in $\flags$ and the set of compositions of $r$ into $n$ parts. More precisely, the map
\begin{equation*}
\flags\to\compositions:L\mapsto |L|=\left(\dim(L_1/L_0),\ldots,\dim(L_n/L_{n-1})\right)
\end{equation*}
is constant on $G$-orbits and gives a bijection $\flags/G\cong\compositions$, where $\compositions=\{\lambda\in\naturals^n: \lambda_1+\cdots +\lambda_n = r\}$ is the set of compositions of $r$ into $n$ parts. Given $\lambda\in\compositions$, the corresponding $G$-orbit in $\flags$ is $\flags_\lambda=\{L\in\flags:|L|=\lambda\}$.

Similarly, $G$ acts on $\dblflags$ by $g\cdot (L,L') = (g\cdot L,g\cdot L')$, for $g\in G$ and $(L,L')\in\dblflags$. The $G$-orbits in $\dblflags$ admit a similar combinatorial description. Given $i,j\in\integers$, define a function
\begin{equation*}
a_{i,j}\colon\dblflags\to\integers:(L,L')\mapsto \dim\left(\frac{L_i\cap L_j'}{L_i\cap L_{j-1}' + L_{i-1}\cap L_j'}\right).
\end{equation*}

Note that $a_{i,j}$ is constant on $G$-orbits and $a_{i,j}=a_{i-n,j-n}$. Let $\matrices$ be the set of matrices $A=(a_{i,j})_{i,j\integers}$ with entries $a_{i,j}\in\naturals$ satisfying the following conditions: $a_{i-n,j-n} = a_{i,j}$ for each $i,j\in\integers$; there are finitely many non-zero entries in each row or column; the sum of the entries in any $n$ consecutive rows (or columns) equals $r$. The map
\begin{equation*}
\dblflags\to\matrices:(L,L')\mapsto (a_{i,j}(L,L'))_{i,j\in\integers}
\end{equation*}
is constant on $G$-orbits and gives a bijection $\dblflags/G\cong\matrices$.


Given $A\in\matrices$, define
\begin{equation*}
\ro{A} = \left( \sum_{j\in\integers}a_{1,j}, \ldots, \sum_{j\in\integers} a_{n,j}\right)
\end{equation*}
and
\begin{equation*}
\co{A} = \left( \sum_{i\in\integers} a_{i,1}, \ldots, \sum_{i\in\integers} a_{i,n}\right).
\end{equation*}
$\ro{A}$ and $\co{A}$ are compositions of $r$ into $n$ parts, by definition of $\matrices$. If $(L,L')\in\mathcal{O}_A$, then $\ro{A}=|L|$ and $\co{A} = |L'|$.

\section{Convolution algebras}

Let $\field$ be a finite field. Let $V$ be a free $\laurent$-module of rank $r$ ($\laurent =\field[\epsilon,\epsilon^{-1}]$) and let $G$ denote the automorphism group of $V$. $\flags=\flags_\field(n,r)$ is the space of $n$-periodic cyclic flags in $V$; $\flags$ is the set of chains $L=(L_i)_{i\in\integers}$ of lattices in $V$ such that $L_i\subset L_{i+1}$ and $\epsilon L_i = L_{i-n}$ for each $i\in\integers$. Recall that the $G$-orbits in $\flags$ are indexed by compositions of $r$ into $n$ parts and the $G$-orbits in $\dblflags$ are indexed by $\matrices$: Write $\mathcal{O}_A$ for the $G$-orbit in $\dblflags$ corresponding to $A$.

Let $S$ be the set of $G$-invariant functions $\dblflags\to\integers$ with constructible support. Define a product on $S$ as follows: Given $f,g\in S$ define $f\ast g\colon\dblflags\to\integers$ by
\begin{equation*}
(f\ast g)(L,L'') = \sum_{L'} f(L,L')g(L',L'')
\end{equation*}
for $(L,L'')\in\dblflags$. We will see that this operation defines a $\integers$-algebra structure on $S$.

$f\ast g$ is well defined as $f$ and $g$ are supported on finitely many $G$-orbits, so there are only finitely many $L'\in\flags$ such that $f(L,L')\neq 0$ and $g(L',L'')\neq 0$. $f\ast g$ is $G$-invariant and is supported on finitely many orbits, so $f\ast g\in S$. The operation $\ast:S\times S\to S$ is associative: Given $f,g,h\in S$ and $(L,L''')\in\dblflags$ we have
\begin{align*}
((f\ast g)\ast h)(L,L''')
&= \sum_{L''} (f\ast g)(L,L'')h(L'',L''')\\
&= \sum_{L''}\sum_{L'} f(L,L')g(L',L'')h(L'',L''')\\
&= (f\ast (g\ast h))(L,L''').
\end{align*}

The multiplicative identity in $S$ is $\iota\in S$ given by $\iota(L,L') = 1$ if $L=L'$ and $\iota(L,L')=0$ otherwise. Indeed
\begin{equation*}
(\iota\ast f)(L,L'') = \sum_{L'}\iota(L,L')f(L',L'') = f(L,L'')
\end{equation*}
and
\begin{equation*}
(f\ast\iota)(L,L'') = \sum_{L'}f(L,L')\iota(L',L'') = f(L,L'').
\end{equation*}

It follows $(S,\ast)$ is a ring with $1$.

$S$ has a $\integers$-basis consisting of the indicator functions of the $G$-orbits in $\dblflags$. Given $A\in\matrices$, let $e_A\in S$ be the indicator function of the orbit $\mathcal{O}_A$. Write $\gamma_{A,B,C;\mathrm{q}}$ for the structure constants with respect to this basis, where $\mathrm{q}$ is the number of elements of $\field$. Then for any $(L,L'')\in\mathcal{O}_C$ we have
\begin{align*}
\gamma_{A,B,C;\mathrm{q}}
&=(e_A\ast e_B)(L,L'')\\
&= \sum_{L'} e_A(L,L')e_B(L',L'')\\
&= \#\{L':(L,L')\in\mathcal{O}_A \text{ and }(L',L'')\in\mathcal{O}_B\}.
\end{align*}

\section{Affine q-Schur algebras}

Given $A,B,C\in\matrices$, there exists a polynomial $\gamma_{A,B,C}\in\integers[q]$ such that $\gamma_{A,B,C}(\mathrm{q}) = \gamma_{A,B,C;\mathrm{q}}$ for any prime power $\mathrm{q}$, following \cite{lusztig99}. The affine $q$-Schur algebra $\qschur$ is a free $\integers[q]$ module with basis $\{e_A:A\in\matrices\}$ and with multiplication given by
\begin{equation*}
e_A e_B = \sum_{C} \gamma_{A,B,C}e_C.
\end{equation*}

Given $A,B\in\matrices$ define
\begin{equation*}
X_{A,B} = \{(L,L''):\exists L'\in\flags\text{ with } (L,L')\in\mathcal{O}_A \text{ and } (L',L'')\in\mathcal{O}_B\}.
\end{equation*}

\begin{observation}
There are only finitely many $G$-orbits in $X_{A,B}$.
\end{observation}

{\color{gray}
\begin{proof}
There are $a,b\in\integers$ (depending only on $A$ and $B$) such that
\begin{equation*}
\epsilon^aL \subset L'\subset \epsilon^{-a}L
\end{equation*}
and
\begin{equation*}
\epsilon^bL' \subset L''\subset \epsilon^{-b}L',
\end{equation*}
whenever $(L,L')\in\mathcal{O}_A$ and $(L',L'')\in\mathcal{O}_B$. In this case,
\begin{equation*}
\epsilon^cL \subset L''\subset \epsilon^{-c}L
\end{equation*}
where $c=a+b$. The $G$-orbits in $X_{A,B}$ are indexed by the finite set of $A\in\matrices$ with $a_{i,j}=0$ whenever $|j-i|>cn$.
\end{proof}
}

Given $A\in\matrices$ and $L\in\flags$, define
\begin{equation*}
X_A^L = \{L'\in\flags:(L,L')\in\mathcal{O}_A\}
\end{equation*}

Write $a=\ro{A}$, $a'=\co{A}$. Then $X_A^L \subset \flags_{a'}$ and $X_A^L$ is non-empty if and only if $L\in\flags_a$. Let $A,B\in\matrices$ and $(L,L'')\in\dblflags$. Consider the set
\begin{equation*}
X_A^L\cap X_{B^T}^{L''} = \{L':(L,L')\in\mathcal{O}_A \text{ and } (L',L'')\in\mathcal{O}_B\}
\end{equation*}

Observe that $X_A^L\cap X_{B^\transpose}^{L''}$ is non-empty precisely when $(L,L'')\in X_{A,B}$. Let $(L,L'')\in X_{A,B}$ and take $g\in G$. The natural map
\begin{equation*}
X_A^L\cap X_{B^\transpose}^{L''}\to X_A^{gL}\cap X_{B^\transpose}^{gL''}:L'\mapsto gL'
\end{equation*}
is a bijection. In the case $\field$ is a finite field with $\mathrm{q}=\#\field$ elements, the number of elements in $X_A^L\cap X_{B^\transpose}^{L''}$ depends only on $\mathrm{q}$, $A$, $B$ and the orbit of $(L,L'')$. Thus there are integers $\gamma_{A,B,C;\mathrm{q}}$ such that, for any finite field $\field$ with $\mathrm{q}$ elements and any $(L,L'')\in\mathcal{O}_C$,
\begin{equation*}
\gamma_{A,B,C;\mathrm{q}} = \# X_A^L\cap X_{B^\transpose}^{L''}.
\end{equation*}

\section{Relation to the Ringel-Hall algebra of a cyclic quiver.}

Let $\field$ be a field. $L\in\flags$ determines an infinite dimensional $\field\cyclic$-module; corresponding to the representation
\begin{align*}
L_1 &\hookrightarrow L_2 \cdots\hookrightarrow L_n &&\to L_1\\
x &\mapsto x\cdots\mapsto && x\mapsto \epsilon x.
\end{align*}

If $(L,L')\in\dblflags$ with $L'\subset L$, we have a short exact sequence in $Mod(\field\cyclic)$:
\begin{equation*}
L'\to L\to L/{L'},
\end{equation*}
where $L/L'$ is a finite dimensional nilpotent $\field\cyclic$-module.


\chapter{Quivers with relations for affine q-Schur algebras.}


\section{Basic results: TO BE REPLACED WITH A MORE INFORMATIVE NAME.}

$(L,L')\in\mathcal{O}_A$ if and only if $(L',L)\in\mathcal{O}_{A^\transpose}$. In fact, the operation of transposition on $\dblflags$ (or on $\matrices$) induces an anti-automorphism of $\qschur$.
\begin{lemma}
Transposition gives a homomorphism of $\integers[q]$-modules $\transpose\colon\qschur\to\qschur$ with $\transpose(e_A) = e_{A^\transpose}$, $\transpose\circ\transpose = 1$ and $\transpose(e_A e_B) = \transpose(e_B)\transpose(e_A)$.
\end{lemma}
\begin{proof}
Let $A,B,C\in\matrices$ and let $\field$ be a finite field with $\mathrm{q}=\#\field$ elements. If $(L,L'')\in\mathcal{O}_C$ then $(L'',L)\in\mathcal{O}_{C^\transpose}$ and
\begin{align*}
\gamma_{A,B,C;\mathrm{q}}
&= \#\{L': (L,L')\in\mathcal{O}_A\text{ and } (L',L'')\in\mathcal{O}_B\}\\
&= \#\{L': (L'',L')\in\mathcal{O}_{B^\transpose}\text{ and } (L',L)\in\mathcal{O}_{A^\transpose}\}\\
&= \gamma_{B^\transpose,A^\transpose, C^\transpose;\mathrm{q}}
\end{align*}
It then follows that $\transpose(e_A e_B) = \transpose(e_B) \transpose(e_A)$. The other parts of the statements are clear.
\end{proof}

If $i,j\in\integers$, let $\mathcal{E}_{i,j}$ denote the `elementary matrix' with entries given by $(\mathcal{E}_{i,j})_{s,t}=1$, for $s,t\in\integers$,  whenever $(i,j)\sim (s,t)$ modulo $(n,n)$ and all other entries are zero.

Given $\lambda\in\compositions$, let $D_\lambda\in\matrices$ denote the diagonal matrix with $r(D_\lambda)=c(D_\lambda) = \lambda$. That is,
\begin{equation*}
D_\lambda = \lambda_1 \mathcal{E}_{1,1} +\cdots + \lambda_n \mathcal{E}_{n,n}
\end{equation*}

For $\lambda\in\compositions$, write $1_\lambda = e_{D_\lambda}$. The $1_\lambda$ are pairwise orthogonal idempotents in $\qschur$ with $1 = \sum_{\lambda\in\compositions}1_\lambda$.

Given $i,j\in\integers$, write $X_{i,j} = \mathcal{E}_{i,j} - \mathcal{E}_{i+1,j}$. By convention, $e_A = 0$ unless $A\in\matrices$.

For $i\in [1,n]$ and $\lambda\in\compositions$, write
\begin{equation*}
E_{i,\lambda} = e_{D_\lambda + X_{i,i+1}},
\end{equation*}
\begin{equation*}
F_{i,\lambda} = e_{D_\lambda - X_{i,i}}.
\end{equation*}

Define
\begin{equation*}
E_i = \sum_{\lambda\in\compositions} E_{i,\lambda}
\end{equation*}
\begin{equation*}
F_i = \sum_{\lambda\in\compositions} F_{i,\lambda}.
\end{equation*}

Observe that $E_{i,\lambda}=0$ unless $\lambda_{i+1} > 0$ and $F_{i,\lambda}=0$ unless $\lambda_i > 0$. Also, $E_{i,\lambda} = E_i 1_\lambda$ and $F_{i,\lambda} = F_i 1_\lambda$. 
\begin{lemma}
Let $i\in [1,n]$ and $A\in\matrices$.
\begin{equation*}
E_ie_A = \sum_{p\in\integers} q^{\sum_{j>p} a_{i,j}}[a_{i,p}+1] e_{A + X_{i,p}}
\end{equation*}
and
\begin{equation*}                                                                               
F_ie_A = \sum_{p\in\integers} q^{\sum_{j<p} a_{i+1,j}}[a_{i+1,p}+1] e_{A - X_{i,p}}.
\end{equation*}
\end{lemma}

Note that these formulas are still valid in the cases $E_ie_A=0$ and $F_ie_A=0$. There are similar formulas for right multiplication by $E_i$ and $F_i$, which can be obtained by applying the transpose involution to the above formulas. The transpose relates the $E_i$, $F_i$ and $1_\lambda$ in the following way: $\transpose(E_{i,\lambda}) = F_{i,\lambda}$, $\transpose(F_{i,\lambda}) = E_{i,\lambda -\epsilon_i +\epsilon_{i+1}}$ and $\transpose(1_\lambda) = 1_\lambda$. In particular, $\transpose(E_i) = F_i$ and $\transpose(F_i) = E_i$.

\begin{corollary}
Let $j\in [1,n]$ and $A\in\matrices$. Then
\begin{equation*}
e_A F_j = \sum_{p\in\integers} q^{\sum_{i>p} a_{i,j}}[a_{p,j}+1] e_{A+X_{j,p}^{\transpose}}
\end{equation*}
and
\begin{equation*}
e_A E_j = \sum_{p\in\integers} q^{\sum_{i<p} a_{i,j+1}}[a_{p,j+1}+1] e_{A-X_{j,p}^{\transpose}}
\end{equation*}
\end{corollary}
\begin{proof}
\begin{align*}
e_A F_j &= \transpose (E_j e_{A^\transpose})\\
&= \transpose ( \sum_p q^{\sum_{i>p} a_{i,j}}[a_{p,j}+1] e_{A^\transpose + X_{j,p}} )\\
&= \sum_p q^{\sum_{i>p} a_{i,j}} [a_{p,j}+1] e_{A+X_{j,p}^{\transpose}}
\end{align*}

\begin{align*}
e_A E_j &= \transpose (F_j e_{A^\transpose})\\
&= \transpose ( \sum_p q^{\sum_{i<p} a_{i,j+1}} [a_{p,j+1}+1] e_{A^\transpose - X_{j,p}} )\\
&= \sum_p q^{\sum_{i<p} a_{i,j+1}}[a_{p,j+1}+1] e_{A-X_{j,p}^{\transpose}}
\end{align*}
\end{proof}

Note that $E_i^{r+1}=F_i^{r+1}=0$ while
\begin{equation*}
E_i^r = [r]_! e_{r\mathcal{E}_{i,i+1}}
\end{equation*}
and
\begin{equation*}
F_i^r = [r]_! e_{r\mathcal{E}_{i+1,i}}.
\end{equation*}

\begin{lemma}[quantum Serre relations: $n\geq 3$]
Suppose $n\geq 3$. The following relations hold in $\qschur$:
\begin{equation*}
E_i E_j - E_j E_i = 0
\end{equation*}
\begin{equation*}
F_i F_j - F_j F_i = 0
\end{equation*}
unless $j=i\pm 1$;
\begin{align*}
E_i E_{i+1}^2 - (1+q)E_{i+1} E_i E_{i+1} + qE_{i+1}^2 E_i &= 0\\
E_i^2 E_{i+1} - (1+q)E_i E_{i+1} E_i + qE_{i+1} E_i^2 &= 0
\end{align*}
and
\begin{align*}
F_{i+1} F_i^2 - (1+q) F_i F_{i+1} F_i + qF_i^2 F_{i+1} &=0\\
F_{i+1}^2 F_i - (1+q) F_{i+1} F_i F_{i+1} + q F_i F_{i+1}^2 &= 0.
\end{align*}
\end{lemma}
\begin{proof}
Here we introduce temporary notation for the basis elements: Write $[ A] = e_A$.

% first relation for Es:
Take $\lambda\in\compositions$.
\begin{equation*}
E_i E_{i+1}^2 1_\lambda = [2][ {D_\lambda + 2X_{i+1,i+2} + X_{i,i+2} }] + [2][ { D_\lambda + 2X_{i+1,i+2} + X_{i,i+1} }]
\end{equation*}                                                                                                                                                                                                                                                                                                                                      

\begin{equation*}
E_{i+1} E_i E_{i+1} 1_\lambda = [ {D_\lambda + 2X_{i+1,i+2} + X_{i,i+1} } ] + [2][ { D_\lambda + 2X_{i+1,i+1} + X_{i,i+1} } ]
\end{equation*}

\begin{equation*}
E_{i+1}^2 E_i 1_\lambda = [2][ { D_\lambda + 2X_{i+1,i+2} + X_{i,i+1} } ]
\end{equation*}
Then
\begin{equation*}
(E_i E_{i+1}^2 - (1+q)E_{i+1} E_i E_{i+1} + qE_{i+1}^2 E_i)1_\lambda = 0,
\end{equation*}
for each $\lambda\in\compositions$. The relation $E_i E_{i+1}^2 - (1+q)E_{i+1} E_i E_{i+1} + qE_{i+1}^2 E_i = 0$ then follows.

% Second relation for Es:
% ...
% ...

The relations between $F_i$ and $F_{i+1}$ may be obtained directly, as above, or by applying the transpose operator to the relations already derived: note that the two sets of relations are related by swapping $E_i$ and $F_i$ and reversing the order of multiplication.
\end{proof}



\begin{lemma}[quantum Serre relations: $n=2$]
{\color{gray} In the case $n=2$, the quantum Serre relations will be of total degree $4$. Look at the presentation of quantum groups for candidate relations. If that fails, brute force won't be too hard.}
\end{lemma}

\begin{lemma}
$[E_i, F_j] = 0$ unless $j=i$.
\begin{equation*}
E_i F_i - F_i E_i = \sum_{\lambda\in\compositions} ([\lambda_i] - [\lambda_{i+1}])1_\lambda.
\end{equation*}
\end{lemma}


{\color{gray}
For $\lambda\in\compositions$, let $R_\lambda = e_{\lambda_1\mathcal{E}_{0,1}+\cdots +\lambda_n\mathcal{E}_{n-1,n}}$. Write $R = \sum_{\lambda\in\compositions} R_\lambda$. Note $R_\lambda = R 1_\lambda$. Given $A\in\matrices$ and $m\in\integers$, let $A[m]\in\matrices$ be given by $A[m]_{i,j} = a_{i,j+m}$ and let $A^{[m]}$ be given by $A^{[m]}_{i,j} = a_{i+m,j}$ for each $i\in\integers$.

\begin{lemma}[Shifting]
If $A\in\matrices$ then
\begin{equation*}
R e_A = e_{A^{[\pm 1]}}
\end{equation*}
and
\begin{equation*}
e_A R = e_{A_{[\pm 1]}}.
\end{equation*}
\end{lemma}

Conjugation by $R$ gives an automorphism $\rho$ of $\qschur$ satisfying $\rho^n = 1$.
}

\section{quivers with relations}

Denote by $\compositions$ the set of compositions of $r$ into $n$ parts. That is, $\compositions$ is the set of $\alpha\in\integers^n$ with non-negative entries which sum to $r$. Let $\epsilon_i\in\integers^n$ be the $i$th elementary vector and write $\alpha_i = \epsilon_i  -\epsilon_{i+1}$ for each $i\in [1,n]$. Then $\lambda +\alpha_i\in\compositions$ if $\lambda_{i+1}>0$ and $\lambda -\alpha_i\in\compositions$ if $\lambda_i >0$.

Let $\Gamma=\presentationquiver$ be the quiver with set of vertices $\compositions$, with the following arrows:

For $\lambda\in\compositions$ and $i\in [1,n]$, there is an arrow $e_{i,\lambda}:\lambda\to\lambda +\alpha_i$ if $\lambda_{i+1}>0$ and there is an arrow $f_{i,\lambda}:\lambda\to\lambda -\alpha_i$ if $\lambda_i>0$.

Denote by $\integers[q]\Gamma$ the path $\integers[q]$-algebra of $\Gamma$. Thus $\integers[q]\Gamma$ is a free $\integers[q]$-module with a basis given by the set of paths in $\Gamma$, with multiplication given by the concatenation of paths. If $p$ starts where $q$ ends, the product $pq$ is the path $q$ followed by $p$. Write $e_{i,\lambda}=0$ unless $\lambda,\lambda+\alpha_i\in\compositions$ and write $f_{i,\lambda}=0$ unless $\lambda,\lambda -\alpha_i\in\compositions$.

By construction, there is a homomorphism of $\integers[q]$-algebras
\begin{equation*}
\phi\colon \integers[q]\Gamma\to\qschur
\end{equation*}
given by
\begin{align*}
\phi(e_{i,\lambda}) &= E_{i,\lambda}\\
\phi(f_{i,\lambda}) &= F_{i,\lambda}\\
\phi(k_\lambda) &= 1_{\lambda},
\end{align*}
for $i\in [1,n]$ and $\lambda\in\compositions$.

The image of $\phi$ is the subalgebra of $\qschur$ generated by $E_i$, $F_i$ for $i\in [1,n]$ and $1_\lambda$ for $\lambda\in\compositions$, since $E_{i,\lambda}=E_i1_\lambda$ and $F_{i,\lambda}=F_i1_\lambda$, while $E_i = \sum_\lambda E_{i,\lambda}$ and $F_i = \sum_\lambda F_{i,\lambda}$. In general $\phi$ is not surjective, so this does not always lead to a presentation of $\qschur$.

\subsection{Exceptional case $n=2$.}

Describe the quiver.

Define an ideal of relations in the path algebra.

Write down the homomorphism from the bound quiver algebra to the q-Schur algebra.

\subsection{Typical case $n>2$.}

Suppose $n\geq 3$. Then $\Gamma=\presentationquiver$ has vertex set $\compositions$.\seeyoulater

Define $e_i, f_i\in\integers[q]\presentationquiver$ by
\begin{equation*}
e_i = \sum_{\lambda\in\compositions} e_{i,\lambda}
\end{equation*}
and
\begin{equation*}
f_i = \sum_{\lambda\in\compositions} f_{i,\lambda},
\end{equation*}
with the convention $e_{i,\lambda} = 0$ unless $\lambda_{i+1}>0$ and $f_{i,\lambda} = 0$ unless $\lambda_i>0$. Let $k_\lambda\in\field\cyclic$ denote the constant path at vertex $\lambda$. $\{k_\lambda:\lambda\in\compositions\}$ is a set of pairwise orthogonal idempotents in $\integers[q]\presentationquiver$.

Let $\quiverrelations\subset\integers[q]\presentationquiver$ be the ideal generated by the expressions
\begin{equation*}
e_i e_{i+1}^2 -(1+q)e_{i+1}e_ie_{i+1} + qe_{i+1}^2e_i
\end{equation*}
\begin{equation*}
e_i^2e_{i+1} - (1+q) e_ie_{i+1}e_i + qe_{i+1}e_i^2
\end{equation*}
\begin{equation*}
f_{i+1}f_i^2 - (1+q)f_if_{i+1} f_i + qf_i^2f_{i+1}
\end{equation*}
\begin{equation*}
f_{i+1}^2f_i - (1+q)f_{i+1}f_if_{i+1} + qf_if_{i+1}^2
\end{equation*}
\begin{equation*}
e_if_j - f_je_i - \delta_{i,j} \sum_{\lambda\in\compositions} ([\lambda_i]-[\lambda_{i+1}])k_\lambda
\end{equation*}

Recall that a relation is a $\integers[q]$-linear combination of paths with common start and end vertices. The relations involving paths $\lambda\to\mu$ are given by $1_\mu \text{expr} 1_\lambda$, for each of the above expressions.

\begin{lemma}
There is a homomorphism of $\integers[q]$-algebras
\begin{equation*}
\phi\colon\integers[q]\presentationquiver/{\quiverrelations}\to\qschur
\end{equation*}
given by
\begin{equation*}
\phi(e_{i,\lambda}) = E_{i,\lambda}
\end{equation*}
\begin{equation*}
\phi(f_{i,\lambda}) = F_{i,\lambda}
\end{equation*}
\begin{equation*}
\phi(k_\lambda) = 1_\lambda.
\end{equation*}
\end{lemma}


\chapter{A generic affine Schur algebra.}

\section{Introducing the affine generic algebra}

Assume $\field = \complex$ and fix $n,r\geq 1$. Let $\laurent$ be the $\field$-algebra $\field[\epsilon,\epsilon^{-1}]$ and let $\polys$ be the subalgebra generated by $\epsilon$, namely $\polys=\field[\epsilon]$. Let $V$ be a free $\laurent$-module of rank $r$ and let $\flags = \flags_\field(n,r)$ be the set of $n$-periodic cyclic flags in $V$; so $\flags$ consists of collections $L = (L_i)_{i\in\integers}$ of $\polys$-lattices in $V$ with $L_i\subset L_{i+1}$ for $i\in\integers$ and $\epsilon L_i = L_{i-n}$ for $i\in\integers$.

Let $G$ be the group of $\laurent$-module automorphisms of $V$. Thus $G$ is isomorphic to $\GL{r}{\laurent}$. $G$ acts on $\flags$ with orbits $\{\flags_\lambda:\lambda\in\compositions\}$, where $\compositions$ is the set of compositions of $r$ into $n$ parts.

The diagonal action of $G$ on $\dblflags$ has orbits $\{\mathcal{O}_A:A\in\matrices\}$, where $\mathcal{O}_A$ consists of those pairs of flags with periodic characteristic matrix equal to $A$. In particular, the periodic characteristic matrix of a pair $(L,L')\in\dblflags$ is the $\integers\times\integers$ matrix $A = (a_{i,j})_{i,j\in\integers}$, with
\begin{equation*}
a_{i,j} = \dim\left(\frac{L_i\cap L_j'}{L_{i-1}\cap L_j' + L_i\cap L_{j-1}'}\right),
\end{equation*}
for each $i,j\in\integers$.

\subsection{Not quite a category}

There are maps $\ro,\co\colon\matrices\to\compositions$ given by
\begin{equation*}
\ro{A} = \left(\sum_{j} a_{1,j},\ldots, \sum_{j}a_{n,j}\right)
\end{equation*}
and
\begin{equation*}
\co{A} = \left(\sum_{i} a_{i,1},\ldots, \sum_{i} a_{i,n}\right).
\end{equation*}

Given $A\in\matrices$, write $\co{A}\stackrel{A}{\to}\ro{A}$. Given $\lambda,\mu\in\compositions$ the morphisms from $\lambda$ to $\mu$ will be those $A\in\matrices$ with $\co{A} = \lambda$ and $\ro{A} = \mu$. The purpose of this chapter is to define a category with objects $\compositions$ and morphisms $\matrices$; where $\HOM(\lambda,\mu) = \{A\in\matrices: \ro{A}=\mu,\co{A}=\lambda\}$. Given $A,B\in\matrices$ let $\matrices_{A,B}$ be the set of $C\in\matrices$ such that there exist $L,L',L''\in\flags$ with $(L,L')\in\mathcal{O}_A$, $(L',L'')\in\mathcal{O}_B$ and $(L'',L''')\in\mathcal{O}_C$. It will be shown that $\matrices$ admits a partial order $\le$ such that $\matrices_{A,B}$ has a maximum element $A\ast B$, whenever $\co{A} = \ro{B}$. It will be shown that $\ast$ is associative, so defining the composition of morphisms in the category formed by $\compositions$ and $\matrices$.

The generic affine Schur algebra $\generic$ will then be a $\integers$-algebra defined as a linearisation of this category. It will be shown that $\hat{G}(n,r)$ gives a realisation of the affine $0$-Schur algebra $\hat{S}_0(n,r)$ when $r<n$. It is expected that a more refined presentation of the generic algebra and the 0-Schur algebra will allow the conditions on the parameters to be relaxed slightly: the $r=n$ case is approachable, which may extend to the case $r<2n$.

\section{A partial order}

Given $i,j\in\integers$, define a map $d_{i,j}$ on $\matrices$ by setting
\begin{equation*}
d_{i,j}A = \sum_{s\le i,t>j} a_{s,t}
\end{equation*}
for each $A\in\matrices$.

\begin{lemma}\label{lemma:differentials}
Let $A\in\matrices$, with $A=(a_{i,j})_{i,j\in\integers}$ and write $d_{i,j} = d_{i,j}A$ for $i,j\in\integers$. Then
\begin{equation*}
d_{i+1,j} - d_{i,j} = \sum_{t>j}a_{i+1,t}
\end{equation*}
and
\begin{equation*}
d_{i,j+1}-d_{i,j} = - \sum_{s\le i}a_{s,j}.
\end{equation*}
\end{lemma}

\begin{proof}
Let $i,j\in\integers$. Then
\begin{equation*}
d_{i+1,j} - d_{i,j} = \sum_{s\le i+1,t>j}a_{s,t} - \sum_{s\le i,t>j}a_{s,t} = \sum_{t>j}a_{i+1,t}.
\end{equation*}
Similarly,
\begin{equation*}
d_{i,j+1}-d_{i,j} = \sum_{s\le i,t>j+1}a_{s,t} - \sum_{s\le i,t>j}a_{s,t} = -\sum_{s\le i}a_{s,j}.
\end{equation*}
\end{proof}

\begin{lemma}\label{lemma:antisymmetry}
Let $A\in\matrices$, with $A = (a_{i,j})_{i,j\in\integers}$ and write $d_{i,j}=d_{i,j}A$ for each $i,j\in\integers$. Then
\begin{equation*}
a_{i,j} = d_{i,j-1} - d_{i-1,j-1} + d_{i-1,j} - d_{i,j}
\end{equation*}
for each $i,j\in\integers$.
\end{lemma}
\begin{proof}
Using lemma \ref{lemma:differentials},
\begin{align*}
a_{i,j}
&= \sum_{t>j-1}a_{i,t} - \sum_{t>j}a_{i,t}\\
&= (d_{i,j-1} - d_{i-1,j-1}) - (d_{i,j} - d_{i-1,j}).
\end{align*}
Alternatively,
\begin{align*}
a_{i,j}
&= \sum_{s\le i}a_{s,j} - \sum_{s\le i-1}a_{s,j}\\
&= (d_{i,j-1} - d_{i,j}) - (d_{i-1,j-1} - d_{i-1,j}).
\end{align*}
\end{proof}

\begin{lemma}\label{lemma:orbit-poset}
The relation $\le$ on $\matrices$, defined by $A\le B$ if and only if $d_{i,j}A\le d_{i,j}B$
for all $i,j\in\integers$, is a partial order.
\end{lemma}

\begin{proof}
It is clear that $\le$ is reflexive and transitive, so it remains to see $\le$ is antisymmetric. Suppose $A,B\in\matrices$ with $A\le B$ and $B\le A$. Then $d_{i,j}A = d_{i,j}B$ for each $i,j\in\integers$, which shows $A=B$ as a result of lemma \ref{lemma:antisymmetry}.  
\end{proof}

The partial order on $\matrices$ induces a partial order on the set of $G$-orbits in $\dblflags$, such that $\mathcal{O}_A\le \mathcal{O}_B$ if and only if $A\le B$. The next lemma gives some geometric significance to the partial order on $\matrices$.

\begin{lemma}
Let $A\in\matrices$ and take $(L,L')\in\mathcal{O}_A$. Then
\begin{equation*}
d_{i,j}A = \dim\left(\frac{L_i}{L_i\cap L_j'}\right)
\end{equation*}
for each $i,j\in\integers$.
\end{lemma}

{\color{red}It is thought* that the partial order on $\matrices$ is compatible with the degeneration order (or closure order) on $G$-orbits in $\dblflags$ when $\field=\complex$. In particular, it is hoped that $\mathcal{O}_A\le \mathcal{O}_B$ if and only if $\mathcal{O}_A\subset \overline{\mathcal{O}_B}$.}

\section{Preliminary results}

Fix $L\in\flags$.

\begin{lemma}
$L_0/{\epsilon L_0}$ is a torsion $\field[\epsilon]$-module, where $\epsilon$ acts as zero, with dimension $r$ as a $\field$-vector space.
\end{lemma}
\begin{proof}
Let $V = \field[\epsilon,\epsilon^{-1}]^r$. $L_0$ is a free $\field[\epsilon]$-module of rank $r$, with $L_0\subset V$. So we may take a $\field[\epsilon]$-basis $x_1,\ldots, x_r\in V$ for $L_0$. The action of $\epsilon$ gives an automorphism of $V$ mapping $L_0$ to $\epsilon L_0$, so $\epsilon x_1,\ldots,\epsilon x_r$ give a basis for $\epsilon L_0$ over $\field[\epsilon]$. Therefore, the cosets $x_1 + \epsilon L_0,\ldots x_r +\epsilon L_0$ give a basis for $L_0/{\epsilon L_0}$ over $\field$.
\end{proof}

Suppose $A,B\in\matrices$ with $\co{A}=\ro{B}$. Recall the notation
\begin{equation*}
Y_{A,B} = \{(L,L',L'')\in\flags^3: (L,L')\in\mathcal{O}_A, (L',L'')\in\mathcal{O}_B\}
\end{equation*}
and
\begin{equation*}
X_{A,B} = \{(L,L'')\in\flags^2:\exists L'\in\flags \text{ with } (L,L',L'')\in Y_{A,B}\}.
\end{equation*}

$X_{A,B}$ is the image of $Y_{A,B}$ under the projection onto the first and last components.

\begin{lemma}\label{lemma:orbit-products-are-bounded}
There is $N\in\naturals$ such that
\begin{equation*}
\epsilon^N L_0\subset L_0''\subset \epsilon^{-N}L_0
\end{equation*}
whenever $(L,L'')\in X_{A,B}$.
\end{lemma}

\begin{proof}
There exist $N_1,N_2\in\naturals$ such that
\begin{equation*}
\epsilon^{N_1}L_0\subset L_0'\subset \epsilon^{-N_1}L_0
\end{equation*}
and
\begin{equation*}
\epsilon^{N_2}L_0'\subset L_0''\subset \epsilon^{-N_2}L_0',
\end{equation*}
whenever $(L,L',L'')\in Y_{A,B}$. Then, for $(L,L',L'')\in Y_{A,B}$,
\begin{equation*}
L_0''\subset \epsilon^{-N_2} L_0' \subset \epsilon^{-(N_1+N_2)} L_0
\end{equation*}
and
\begin{equation*}
\epsilon^{N_1+N_2}L_0\subset \epsilon^{N_2}L_0'\subset L_0''.
\end{equation*}

In particular, taking $N=N_1 + N_2$, we have
\begin{equation*}
\epsilon^N L_0 \subset L_0'' \subset \epsilon^{-N}L_0
\end{equation*}
whenever $(L,L'')\in X_{A,B}$.
\end{proof}

\begin{lemma}\label{lemma:codimensions-in-orbit-product}
Suppose $N_1,N_2\in\naturals$ with $\epsilon^{N_1}L_0\subset L_0\subset \epsilon^{-N_1}L_0$ and $\epsilon^{N_2}L_0'\subset L_0''\subset \epsilon^{-N_2}L_0'$ whenever $(L,L',L'')\in Y_{A,B}$ and let $N = N_1 + N_2$. Then
\begin{equation*}
\dim\left(\frac{\epsilon^{-N}L_0}{L_0''}\right) = d_{nN_1,0}(A) + d_{nN_2,0}(B)
\end{equation*}
and
\begin{equation*}
\dim\left(\frac{L_0''}{\epsilon^N L_0}\right) = 2Nr - d_{nN_1,0}(A) + d_{nN_2,0}(B),
\end{equation*}
whenever $(L,L'')\in X_{A,B}$.
\end{lemma}

\begin{proof}
Suppose $(L,L'')\in X_{A,B}$ and $L'\in\flags$ so that $(L,L',L'')\in Y_{A,B}$. As in lemma \ref{lemma:orbit-products-are-bounded}, $\epsilon^N L_0\subset L_0''\subset \epsilon^{-N}L_0$, so
\begin{equation*}
\dim\left(\frac{\epsilon^{-N}L_0}{L_0''}\right) + \dim\left(\frac{L_0''}{\epsilon^N L_0}\right) = \dim\left(\frac{\epsilon^{-N}L_0}{\epsilon^N L_0}\right).
\end{equation*}

As a $\field$-vector space, $\epsilon^{-N}L_0/\epsilon^N L_0$ is isomorphic to $(L_0/{\epsilon L_0})^{2N}$, which has dimension $2Nr$, so
\begin{equation*}
\dim\left(\frac{L_0''}{\epsilon^N L_0}\right) = 2Nr - \dim\left(\frac{\epsilon^{-N}L_0}{L_0''}\right).
\end{equation*}

It remains to compute the codimension of $L_0''$ in $\epsilon^{-N}L_0$. Note $L_0''\subset \epsilon^{-N_2}L_0'\subset \epsilon^{-N} L_0$, so
\begin{equation*}
\dim\left(\frac{\epsilon{-N}L_0}{L_0''}\right) = \dim\left(\frac{\epsilon^{-N}L_0}{\epsilon^{-N_2}L_0'}\right) + \dim\left(\frac{\epsilon^{-N_2}L_0'}{L_0''}\right).
\end{equation*}

\begin{align*}
\dim\left(\frac{\epsilon^{-N}L_0}{\epsilon^{-N_2}L_0'}\right)
&= \dim\left(\frac{\epsilon^{-N_1}L_0}{L_0'}\right)\\
&= \dim\left(\frac{L_{nN_1}}{L_{nN_1}\cap L_0'}\right)\\
&= \sum_{s\le nN_1, t>0} A_{s,t}\\
&= d_{nN_1,0}(A).
\end{align*}

\begin{align*}
\dim\left(\frac{\epsilon^{-N_2}L_0'}{L_0''}\right)
&= \dim\left(\frac{ L_{nN_2}'}{L_{nN_2}'\cap L_0''}\right)\\
&= \sum_{s\le nN_2, t>0} B_{s,t}\\
&= d_{nN_2,0}(B).
\end{align*}
\end{proof}

\subsection{The complex case}

For this section, assume the underlying field is $\complex$ and $L\in\flags$ is fixed. Given $N,a\in\naturals$ and $\lambda\in\compositions$, define
\begin{equation*}
\Pi_{N,\lambda} = \{L''\in\flags_\lambda: \epsilon^N L_0\subset L_0''\subset \epsilon^{-N}L_0\}
\end{equation*}
and
\begin{equation*}
\Pi_{N,\lambda}^a = \left\{L''\in\flags_\lambda: \epsilon^N L_0\subset L_0''\subset \epsilon^{N}L_0, \dim\left(\frac{\epsilon^{-N}L_0}{L_0''}\right) = a\right\}.
\end{equation*}

$\Pi_{N,\lambda}$ is the (disjoint) union of the $\Pi_{N,\lambda}^a$ for $a\in\naturals$. In fact, we will see $\Pi_{N,\lambda}^a$ is empty whenever $a > 2Nr$.

\begin{lemma}
Let $N,a\in\naturals$, $\lambda\in\compositions$. Then $\Pi_{N,\lambda}
^a$ is nonempty exactly when $0\le a \le 2Nr$.
\end{lemma}

\begin{proof}
Suppose $L''\in\Pi_{N,\lambda}$. By definition, $\epsilon^{-N}L_0\subset L_0''\subset \epsilon^{-N}L_0$, which shows
\begin{equation*}
\dim\left(\frac{\epsilon^{-N}L_0}{L_0''}\right) \le \dim\left(\frac{\epsilon^{-N}L_0}{\epsilon^N L_0}\right) = 2Nr.
\end{equation*}
Therefore, $\Pi_{N,\lambda}^a$ is empty unless $a\le 2Nr$.

Now assume $0\le a\le 2Nr$. We may choose an $\epsilon$-invariant subspace $W'$ of $W = \epsilon^{-N}L_0/{\epsilon^N L_0}$ of codimension $a$. $W'$ lifts to give a $\complex[\epsilon]$-module, say $L_0''$, with $\epsilon^N L_0\subset L_0''\subset \epsilon^{-N}L_0$ and with $\dim(\epsilon^{-N}L_0/{L_0''}) = \dim(W/W') = a$. Similarly, a flag of type $\lambda$ in $L_0''/{\epsilon L_0''}$ lifts to give $\complex[\epsilon]$-modules $(L_{-n+1}'',\ldots,L_0'')$ with
\begin{equation*}
\epsilon L_0''\subset L_{-n+1}''\subset\cdots\subset L_{-1}''\subset L_0''\subset \epsilon^{-N}L_0
\end{equation*}
and such that the dimensions of successive quotients are given by $\lambda_1,\ldots,\lambda_n,a$, from left to right. Thus, $(L_{-n+1}'',\ldots,L_0'')$ extends by periodicity to give an element of $\Pi_{N,\lambda}^a$, as desired.
\end{proof}

\begin{lemma}
$\Pi_{N,\lambda}^a$ is a (quasi)projective variety, provided $0\le a\le 2Nr$.
\end{lemma}
\begin{proof}
Let $W= \epsilon^{-(1+N)}L_0/{\epsilon^N L_0}$ and let
\begin{equation*}
X = \left\{W_1\le\cdots\le W_n\le W:\dim\left(\frac{W}{W_n}\right)=a, \dim\left(\frac{W_i}{W_{i-1}}\right) = \lambda_i \text{ for } i=2,\ldots,n\right\}.
\end{equation*}

$X$ is known to be a projective variety {\color{red}[CITATION NEEDED]}

Let $X'$ be the subset of $X$ consisting of those $(W_1,\ldots, W_n)$, where each $W_i$ is $\epsilon$-invariant and $\epsilon W_n \le W_1$. $X'$ is a closed subset of $X$, though is not necessarily irreducible.

The correspondence between the set of $\complex[\epsilon]$-submodules of $\epsilon^{-(1+N)}L_0$ which contain $\epsilon^N L_0$ and the set of $\complex[\epsilon]$-submodules of $\epsilon^{-(1+N)}L_0/{\epsilon^N L_0}$ gives a pair of mutually inverse maps $\Pi_{N,\lambda}^a\leftrightarrow X'$.


\end{proof}

\begin{remark}\color{blue}
 -- the idea that is relevant to the proof is that inclusion relations $L_i\subset L_{i+1}$ describe a closed set in a product of grassmanians.
 
 Unsure here -- Is it true that irreducible components of $X'$ are projective varieties. In this case, should the statement be that $\Pi_{N,\lambda}^a$ is a projective algebraic set, rather that a quasi projective variety?
\end{remark}

\begin{lemma}
Suppose $(L',L'')\in\mathcal{O}_B$ with $(L,L')\in\mathcal{O}_A$. Then $X_{A,B}^L$ is the image of the map
\begin{equation*}
G_L\times G_{L'}\to\flags: (\alpha,\beta)\mapsto \alpha\beta L''.
\end{equation*}
\end{lemma}

\begin{proof}
Suppose $\alpha\in G_L$ and $\beta\in G_{L'}$. $(L,\alpha L',\alpha\beta L'')\in Y_{A,B}$ since $(L,\alpha L')\sim (L,L')\in\mathcal{O}_A$ and $(\alpha L',\alpha\beta L'')\sim (L',L'')\in\mathcal{O}_B$. This shows $(L,\alpha\beta L'')\in X_{A,B}$ and thus $\alpha\beta L''\in X_{A,B}^L$.

Conversely, suppose $N''\in X_{A,B}^L$. $(L,N'')\in X_{A,B}$, so there is $N'$ such that $(L,N')\in\mathcal{O}_A$ and $(N',N'')\in\mathcal{O}_B$. There exist $\gamma,\delta\in G$ such that $\gamma (L,L') = (N,N')$ and $\delta (L',L'') = (N',N'')$. Then $(L,N',N'') = (L,\gamma L', \delta L'') = (L, \gamma L',\gamma (\gamma^{-1}\delta)L'')$, where $\gamma\in G_L$ and $\gamma^{-1}\delta\in G_{L'}$. This shows $N'' \in G_L G_{L'} L''$ as required.
\end{proof}

Given $N\in\naturals$, define
\begin{equation*}
H_N = \left\{ h\in G_L: h=1 \text{ on } \frac{\epsilon^{-(1+N)}L_0}{\epsilon^N L_0} \right\}.
\end{equation*}
Explicitly, the condition $h=1$ on $\epsilon^{-(1+N)}L_0/{\epsilon^N L_0}$ means: $h(x) + \epsilon^N L_0 = x + \epsilon^N L_0$ for $x\in\epsilon^{-(1+N)}L_0$. Observe that $H_{N+1}\subset H_N$ for $N\in\naturals$ since $h(x) + \epsilon^N L_0 = x + \epsilon^N L_0$ whenever $x\in\epsilon^{-(1+N)}L_0$.

\begin{lemma}
$H_N$ is a normal subgroup in $G_L$, for any $N\in\naturals$.
\end{lemma}

\begin{proof}
$H_N\subset G_L$ by definition. Suppose $h,h'\in H_N$ and let $x\in\epsilon^{-(1+N)}L_0$. $h'(x)\in\epsilon^{-(1+N)}L_0$ as $h'\in G_L$, so $hh'(x) + \epsilon^N L_0 = h'(x) + \epsilon^N L_0 = x + \epsilon^N L_0$, which shows $hh'\in H_N$. $h(x)-x\in\epsilon^N L_0$, so $h^{-1}(x) - x = -h^{-1}(h(x)-x)\in\epsilon^N L_0$. $h^{-1}\in H_N$, so $H_N$ is a subgroup of $G_L$.

Let $g\in G_L$. $hg^{-1}(x) + \epsilon^N L_0 = g^{-1}(x)$ as $g^{-1}(x)\in\epsilon^{-(1+N)}L_0$, so $ghg^{-1}(x) + \epsilon^N L_0 = gg^{-1}(x) + \epsilon^N L_0 = x + \epsilon^N L_0$. Thus $ghg^{-1}\in H_N$, which proves $H_N$ is a normal subgroup in $G_L$.
\end{proof}

\begin{lemma}
$G_L/H_N$ is an (irreducible) algebraic group, for any $N\in\naturals$.
\end{lemma}

The $H_N$ form a descending chain of normal subgroups in $G_L$: $\cdots\subset H_1 \subset H_0 \subset G_L \subset G$.

\begin{lemma}
There is $N\in\naturals$ such that $H_N\subset G_{L'}$. Consequently, $H_{N'}\subset G_{L'}$ whenever $N'\geq N$.
\end{lemma}
\begin{proof}
Choose $N\in\naturals$ such that $\epsilon^N L_0\subset L_0'\subset \epsilon^{-N}L_0$. Then
\begin{equation*}
\epsilon^N L_0 \subset L_0'\subset L_1'\subset\cdots\subset L_n' \subset \epsilon^{-(1+N)}L_0.
\end{equation*}
Let $h\in H_N$. $h(x) + \epsilon^N L_0 = x + \epsilon^N L_0$ for $x\in\epsilon^{-(1+N)} L_0$, so $h(L_i')\subset L_i'$ for $i=0,1,\ldots,n$. Moreover, $h^{-1}$ stabilises $L_i'$, so $h(L_i') = L_i'$ for $i=0,1,\ldots,n$ and therefore for $i\in\integers$. This shows $h\in G_{L'}$ as required, so $H_N\subset G_{L'}$.
\end{proof}

Note that $H_N$ is generally not a normal subgroup of $G_{L'}$, though the space of (right) cosets of $H_N$ in $G_{L'}$ will still be irreducible.

\begin{lemma}
$G_{L'}/H_N$ is irreducible, provided $H_N\subset G_{L'}$.
\end{lemma}

\section{Existence of a maximum}

\begin{proposition}\label{proposition:existence-maximum}
Given $A,B\in\matrices$ with $\co{A}=\ro{B}$, $\matrices_{A,B}$ has a maximum element.
\end{proposition}

\begin{proof}[Draft of proof]
$\matrices_{A,B}$ is non-empty since $\co{A}=\ro{B}$. The partial order on $\matrices_{A,B}$ is given by the partial order on $\matrices$; where $C'\le C$ if and only if $d_{i,j}C'\le d_{i,j}C$ for all $i,j\in\integers$.

To prove existence of a maximum element in $\matrices_{A,B}$ we will consider the poset of $G$-orbits in $\dblflags$ and prove existence of a maximum orbit in $X_{A,B}$ using an open orbits argument. Recall $X_{A,B}$ consists of $(L,L'')\in\dblflags$ such that there exists $L'\in\flags$ with $(L,L')\in\mathcal{O}_A$ and $(L',L'')\in\mathcal{O}_B$.

There is $N\in\naturals$ such that $\epsilon^N L_0\subset L_0''\subset \epsilon^{-N}L_0$ whenever $(L,L'')\in X_{A,B}$. Fix $L\in\flags_{\ro{A}}$ and write
\begin{equation*}
X_{A,B}^L = \{L''\in\flags: (L,L'')\in X_{A,B}\}.
\end{equation*}
With the above choice of $N$, write
\begin{equation*}
\Pi = \{L''\in\flags_{\co{B}}: \epsilon^N L_0\subset L_0''\subset \epsilon^{-N} L_0\}.
\end{equation*}

$\Pi$ is a complex projective variety (not generally irreducible), closed under the action of $G_L$. \needsreference The closure $\overline{X_{A,B}^L}$ of $X_{A,B}^L$ in $\Pi$ is an irreducible complex projective variety.

Proposition \needsreference shows there is a unique $G_L$-orbit in $X_{A,B}^L$ which is open in $\overline{X_{A,B}^L}$, say $\mathcal{O}_C^L$ for some $C\in\matrices_{A,B}$. It will be shown that $C$ is the maximum element of $\matrices_{A,B}$. Given $i,j\in\integers$, let $m_{i,j}$ denote the maximum of $\{d_{i,j}C: C\in\matrices_{A,B}\}$ and define
\begin{equation*}
\mathcal{M}_{i,j} = \{L''\in \overline{X_{A,B}^L}: d_{i,j}(L,L'') = m_{i,j}\}.
\end{equation*}
$\mathcal{M}_{i,j}$ is non-empty by definition of the $m_{i,j}$ and is closed under the action of $G_L$. $\mathcal{M}_{i,j}$ is open in $\overline{X_{A,B}^L}$ since the function
\begin{equation*}
d_{i,j}^L\colon\Pi\to\integers: L''\mapsto \dim\left(\frac{L_i}{L_i\cap L_j''}\right)
\end{equation*}
is lower semi-continuous \needsreference and
\begin{equation*}
\mathcal{M}_{i,j} = \overline{X_{A,B}^L}\setminus \{L''\in\overline{X_{A,B}^L}: d_{i,j}^L(L'')\le m_{i,j} -1\}.
\end{equation*}

It follows that $\mathcal{O}_C^L$ and $\mathcal{M}_{i,j}$ intersect non-trivially, since $\overline{X_{A,B}^L}$ is irreducible and therefore $\mathcal{O}_C^L\subset \mathcal{M}_{i,j}$ as both are closed under the action of $G_L$. This proves $C$ is a maximum element of $\matrices_{A,B}$, since
\begin{equation*}
d_{i,j}C = d_{i,j}(L,L'') = m_{i,j}
\end{equation*}
for any $L''\in\mathcal{O}_C^L$.
\end{proof}

\begin{proof}[Short proof]
$\matrices_{A,B}$ is non-empty since $\co{A}=\ro{B}$. For each $i,j\in\integers$, define
\begin{equation*}
m_{i,j} = \max_{C\in\matrices_{A,B}} d_{i,j}C.
\end{equation*}
It will be shown that there is a unique element $A\ast B\in \matrices_{A,B}$ with $d_{i,j}(A\ast B) = m_{i,j}$: such an element is necessarily a maximum in $\matrices_{A,B}$. Fix $L\in\flags_{\ro{A}}$ and assume $N\in\naturals$ is sufficiently large that $X_{A,B}^L\subset \Pi_N$; where
\begin{equation*}
\Pi_N = \{L''\in\flags_{\co{B}}: \epsilon^N L_0\subset L_0''\subset \epsilon^{-N} L_0\}.
\end{equation*}

Lusztig notes \cite{lusztig99} that $\Pi_N$ is a projective algebraic variety, closed under the action of $G_L$. Lemma \needsreference shows that the closure of $X_{A,B}^L$ in $\Pi_N$, denoted $\overline{X_{A,B}^L}$, is an irreducible complex projective variety.

For each $i,j\in\integers$, write
\begin{equation*}
\mathcal{M}_{i,j} = \{L''\in\overline{X_{A,B}^L}: d_{i,j}(L,L'') = m_{i,j}\}.
\end{equation*}

$\mathcal{M}_{i,j}$ is non-empty since $d_{i,j}(L,-)$ attains a maximum on $X_{A,B}^L$. $\mathcal{M}_{i,j}$ is open in $\overline{X_{A,B}^L}$ since
\begin{equation*}
\overline{X_{A,B}^L}\setminus \mathcal{M}_{i,j} = \{L''\in\overline{X_{A,B}^L}: d_{i,j}(L,L'')\le m_{i,j} - 1\}
\end{equation*}
and the function
\begin{equation*}
d_{i,j}(L,-)\colon\Pi_N\to\integers : L''\mapsto \dim\left(\frac{L_i}{L_i\cap L_j''}\right)
\end{equation*}
is lower semi-continuous, by lemma [\needsreference : lower semi-continuity].

Lemma [\needsreference : open orbit] shows that there is a unique $G_L$-orbit in $X_{A,B}^L$ which is open in $\overline{X_{A,B}^L}$, say $\mathcal{O}_{A\ast B}^L$ for some $A\ast B\in\matrices_{A,B}$. $\mathcal{M}_{i,j}$ intersects the open orbit $\mathcal{O}_{A\ast B}^L$ non-trivially, since $\mathcal{M}_{i,j}$ and $\mathcal{O}_{A\ast B}^L$ are both non-empty and open in the irreducible space $\overline{X_{A,B}^L}$. Moreover, $\mathcal{O}_{A\ast B}^L\subset \mathcal{M}_{i,j}$, since $\mathcal{M}_{i,j}$ is closed under the action of $G_L$. In particular, we have $A\ast B\in \matrices_{A,B}$ with $d_{i,j}(A\ast B) = m_{i,j}$ for each $i,j\in\integers$, which shows $A\ast B$ is a maximum in $\matrices_{A,B}$.

More specifically, we may compute:
\begin{equation*}
a_{i,j}(A\ast B) = m_{i,j-1} - m_{i-1,j-1} + m_{i-1,j} - m_{i,j}
\end{equation*}
for each $i,j\in\integers$.
\end{proof}

\section{Associativity}

\begin{proposition}\label{proposition:associativity-maximum}
Given $A,B,C\in\matrices$ with $\co{A}=\ro{B}$ and $\co{B}=\ro{C}$, $(A\ast B)\ast C = A\ast (B\ast C)$.
\end{proposition}
\begin{proof}
INCLUDE PROOF.
\end{proof}

\section{The generic algebra}

This now leads to the construction of a so-called generic version of the affine q-Schur algebra. Let $\generic$ be a free $\integers$-module with basis $\{e_A:A\in\matrices\}$ with $\integers$-bilinear product
\begin{equation*}
e_A\ast e_B = \begin{cases}
e_{A\ast B} \text{ if } \co{A}=\ro{B}\\
0 \text{ if } \co{A}\neq \ro{B}.
\end{cases}
\end{equation*}

Given $\lambda\in\compositions$, let $1_\lambda = e_{\lambda_1\xi_{1,1} + \cdots + \lambda_n\xi_{n,n}}$.

\begin{lemma}\label{lemma:one-sided-identity}
Given $A\in\matrices$, $\lambda\in\compositions$: $1_\lambda e_A = e_A$ provided  $\lambda = \ro{A}$ and $1_\lambda e_A = 0$ if $\lambda\neq \ro{A}$. $e_A1_\lambda = e_A$ if $\lambda = \co{A}$ and $e_A 1_\lambda = 0$ if $\lambda \neq \co{A}$.
\end{lemma}
\begin{proof}
It is clear that $1_\lambda e_A=0$ unless $\lambda = \ro{A}$ and $e_A 1_\lambda = 0$ unless $\lambda = \co{A}$. The basis element $e_A$ may be identified with the corresponding orbit in $\dblflags$; then $1_{\lambda}$ corresponds to the orbit $G(L,L)$, for any $L\in\flags_\lambda$ - denote this orbit by $\mathcal{I}_\lambda$. In the case $\lambda = \ro{A}$, $\pi(\delta^{-1}(\mathcal{I}_\lambda\times\mathcal{O}_A)) = \mathcal{O}_A$, so $\mathcal{I}_\lambda\ast \mathcal{O}_A = \mathcal{O}_A$. Similarly, if $\lambda = \co{A}$, then $\pi(\delta^{-1}(\mathcal{O}_A\times\mathcal{I}_\lambda))$, so $\mathcal{O}_A\ast \mathcal{I}_\lambda = \mathcal{O}_A$.
\end{proof}

\begin{corollary}\label{corollary:idempotents-and-identity}
$\{1_\lambda:\lambda\in\compositions\}$ is a set of pairwise orthogonal idempotents in $\generic$ with $\sum_{\lambda\in\compositions}1_\lambda = 1$.
\end{corollary}

\begin{theorem}
$\generic$ is an associative $\integers$-algebra with $1$.
\end{theorem}
\begin{proof}
Given $A,B\in\matrices$ with $\co{A}=\ro{B}$, proposition \ref{proposition:existence-maximum} shows that there is a maximum element in $\{C\in\matrices: g_{A,B,C}\neq 0\}$, which is denoted $A\ast B$. This shows that the product on $\generic$ is well-defined. If $\co{A}\neq \ro{B}$ or $\co{B}\neq \ro{C}$, then $(e_A\ast e_B)\ast e_C = 0 = e_A\ast (e_B\ast e_C)$. If $\co{A}=\ro{B}$ and $\co{B}=\ro{C}$, then proposition \ref{proposition:associativity-maximum} shows that
\begin{equation*}
(e_A\ast e_B)\ast e_C = e_{(A\ast B)\ast C} = e_{A\ast (B\ast C)} = e_A\ast (e_B\ast e_C).
\end{equation*}

Corollary \ref{corollary:idempotents-and-identity} shows that the sum of the idempotents $1_\lambda$ for $\lambda\in\compositions$ is a multiplicative identity.
\end{proof}

\section{Multiplication rules}

Write
\begin{equation*}
E_i = \sum_{\lambda\in\compositions} E_{i,\lambda}
\end{equation*}
\begin{equation*}
F_i = \sum_{\lambda\in\compositions} F_{i,\lambda}.
\end{equation*}
Then $E_{i,\lambda} = E_i 1_\lambda$ and $F_{i,\lambda} = F_i 1_\lambda$.

\begin{lemma}
Let $A\in\matrices$, $i\in [1,n]$ and let $\lambda = \ro{A}$. The following multiplication rules hold:
\begin{equation*}
E_i e_A = \begin{cases}
e_{A+X_{i,p}} &\text{	if } \lambda_{i+1}>0\\
0 &\text{	if } \lambda_{i+1}=0;
\end{cases}
\end{equation*}
where $p$ is such that $A_{i+1,p}>0$ and $A_{i+1,j}=0$ for $j>p$. Also
\begin{equation*}
F_i e_A = \begin{cases}
e_{A-X_{i,p}} &\text{	if } \lambda_i>0\\
0 &\text{	if } \lambda_i=0;
\end{cases}
\end{equation*}
where $p$ is such that $A_{i,p}>0$ and $A_{i,j}=0$ for $j<p$.
\end{lemma}

Similar formulas for right multiplication by $E_i$ and $F_i$ are obtained by applying the transpose.

\begin{lemma}
The following relations hold in $\generic$ ($n\geq 3$):
\begin{equation*}
E_iE_j - E_jE_i = 0
\end{equation*}
\begin{equation*}
F_iF_j - F_jF_i = 0
\end{equation*}
unless $|j-i|=1$.
\begin{equation*}
E_iE_{i+1}^2 - E_{i+1}E_iE_{i+1} = 0
\end{equation*}
\begin{equation*}
E_i^2E_{i+1} - E_iE_{i+1}E_i = 0
\end{equation*}
\begin{equation*}
F_{i+1}F_i^2 - F_iF_{i+1}F_i = 0
\end{equation*}
\begin{equation*}
F_{i+1}^2F_i - F_{i+1}F_iF_{i+1} = 0
\end{equation*}

\begin{equation*}
E_iF_j - F_jE_i = 0
\end{equation*}
unless $j=i$.
\begin{equation*}
E_iFi - F_iE_i + \sum_{\lambda:\lambda_i = 0,\lambda_{i+1}>0} 1_\lambda - \sum_{\lambda:\lambda_i>0, \lambda_{i+1}=0} 1_\lambda = 0.
\end{equation*}
\end{lemma}


\section{ -- Chapter draft bin -- }

Define
\begin{equation*}
\Pi = \left\{L''\in\flags_{\co{B}} : \epsilon^N L_0 \subset L_0''\subset\cdots\subset L_n''\subset \epsilon^{-N} L_0 \text{ and } \dim\left(L_0''/{\epsilon^N L_0}\right) = -Nr + d_{-Nn,0}^-(A) + d_{-Nn,0}^-(B) \right\}.
\end{equation*}

\begin{lemma}
$\Pi$ is a projective algebraic variety, closed under the action of $G_L$.
\end{lemma}

By choice of $N$, we have $X_{A,B}^L\subset\Pi$.

Write
\begin{equation*}
H = \{g\in G_L: g=1 \text{ on } \epsilon^{-N}L_0/{\epsilon^N L_0}\}.
\end{equation*}
The condition $g=1$ on $\epsilon^{-N}L_0/{\epsilon^N L_0}$ means $g(x) - x\in \epsilon^N L_0$ whenever $x\in\epsilon^{-N} L_0$. It follows that the action of $H$ fixes each lattice $\mathcal{L}$ with $\epsilon^N L_0\subset \mathcal{L}\subset \epsilon^{-N}L_0$.

\begin{lemma}
$H$ is a normal subgroup in $G_L$ and $H$ acts trivially on $\Pi$.
\end{lemma}
\begin{proof}
% first the group property. Multiplicativity:
If $g,g'\in H$, then $gg'\in G_L$ and for $x\in\epsilon^{-N} L_0$ we have
\begin{equation*}
gg'(x)-x = g(g'(x) - x) + g(x) - x.
\end{equation*}
$g(x) - x$ and $g'(x) - x$ are contained in $\epsilon^N L_0$ and $g$ stabilises $L$, so it follows $gg'(x) - x \in \epsilon^N L_0$ as required.

% Inverses
$g^{-1}(x) - x = g^{-1}(x - g(x)) \in\epsilon^N L_0$, since $g^{-1}\in G_L$. Thus $g^{-1}\in H_N^L$. It remains to check normality in $G_L$.

% check normality.
Now suppose $g\in H_N^L$, $h\in G_L$ and take $x\in\epsilon^{-N} L_0$. $h^{-1}(x) \epsilon^{-N} L_0$, since $h^{-1}\in G_L$, so $gh^{-1}(x) - h^{-1}(x)\in\epsilon^{-N} L_0$ then applying $h$ gives that $hgh^{-1}=1$ on $\epsilon^{-N} L_0/{\epsilon^N L_0}$.

%trivial action on Pi.
If $h\in H$ and $L''\in\Pi$, then
\begin{equation*}
\epsilon^N L_0 \subset L_0''\subset\cdots\subset L_n''\subset \epsilon^{-N} L_0
\end{equation*},
so $h(L_i'') = L_i''$ for $i=0,1,\ldots,n$. This proves $h L'' = L''$.
\end{proof}

\begin{lemma}
$H$ is a normal subgroup in $G_{L'}$.
\end{lemma}
\begin{proof}
$H$ fixes any lattice $\mathcal{L}$ with $\epsilon^N L_0\subset \mathcal{L}\subset \epsilon^{-N} L_0$. In particular,
\begin{equation*}
\epsilon^N L_0 \subset L_0'\subset\cdots\subset L_n'\subset \epsilon^{-N} L_0,
\end{equation*}
so $H$ fixes $L_0',\ldots, L_n'$. It follows $H$ is a subgroup in $G_{L'}$, so it remains to prove normality.
\end{proof}

\begin{lemma}
The groups $G_L/H$ and $G_{L'}/H$ are (finite dimensional/ connected/ ...) algebraic groups.
\end{lemma}
\begin{proof}
$\sigma\in G_L$ naturally induces an automorphism $\bar{\sigma}$ of $\epsilon^{-N} L_0/{\epsilon^N L_0}$, with inverse induced by $\sigma^{-1}$. Moreover, the natural map
\begin{equation*}
G_L/H \to GL(\epsilon^{-N}L_0/{\epsilon^N L_0})
\end{equation*}
is a group homomorphism. In fact, this homomorphism is injective: if $\sigma = \tau$ on $\epsilon^{-N}L_0/{\epsilon^N L_0}$, then $\sigma\tau^{-1} = 1$ on $\epsilon^{-N}L_0/{\epsilon^N L_0}$ and so $\sigma H = \tau H$. Thus $G_L/H$ is isomorphic to its image in $GL(\epsilon^{-N}L_0/{\epsilon^N L_0})$. {\color{red}this image is an algebraic group, then I need to deduce $G_L/H$ is an algebraic group.} 
\end{proof}

\begin{lemma}
Suppose $(L,L',L''),(N,N',N'')\in\beta^{-1}(\mathcal{O}_A\times\mathcal{O}_B)$. Then there are $\sigma,\tau\in G$, with $\tau\in G_{L'}$, such that $(N,N',N'') = \sigma(L,L',\tau L'')$.
\end{lemma}
\begin{proof}
There exist $g,g'\in G$ such that $(N,N') = g(L,L')$ and $(N',N'') = g'(L',L'')$. Then $(N,N',N'') = g(L,L',g^{-1}g' L'')$. Taking $\sigma = g$ and $\tau = g^{-1}g'$ gives the required result.
\end{proof}

\begin{proposition}\label{lemma:irreducibility-orbit-product}
Suppose $X_{A,B}^L\neq\emptyset$. Then $X_{A,B}^L\subset\flags_{\co{B}}$ is finite dimensional and irreducible.
\end{proposition}
\begin{proof}
The map
\begin{equation*}
G_L/H\times G_{L'}/H\to\Pi
\end{equation*}
has image $X_{A,B}^L$, so the closure of $X_{A,B}^L$ in $\Pi$ is irreducible {\color{red}due to some properties of the above groups.}
\end{proof}

\subsection{locally closed orbits}

\begin{proposition}\label{lemma:locally-closed-orbits}
Suppose $X_{A,B}^L\neq\emptyset$. The $G_L$-orbits in $X_{A,B}^L$ are locally closed.
\end{proposition}
\begin{proof}
The $G_L$ orbit of $L''\in X_{A,B}^L$ is the image of the map
\begin{equation*}
G_L/H\to\Pi: g\mapsto g L''.
\end{equation*}
{\color{red} Justify why this image must be locally closed.}
% Look at proposition 8.3 "Closed Orbits" in \cite{humphreys81}, which shows that the orbits under an algebraic group action are locally closed.
\end{proof}

\begin{proposition}
Let $A,B\in\matrices$, $L\in\flags$ and suppose $X_{A,B}^L\neq\emptyset$. There is a unique open $G_L$-orbit in $X_{A,B}^L$.
\end{proposition}

\begin{proof}{\color{gray}
Write $X=X_{A,B}^L$. $X$ is irreducible and finite dimensional, using Lemma  \ref{lemma:irreducibility-orbit-product}. We have
\begin{equation*}
X = \bigcup_C O_C,
\end{equation*}
where the union is taken over the finite set $\{C\in\matrices : \mathcal{O}_C\subset X_{A,B}\}$.

A proper, non-empty, closed subset of $X$ has strictly smaller dimension than $X$, so there is $C$ such that $\overline{O_C}=X$. $O_C$ is locally closed, by Lemma \ref{lemma:locally-closed-orbits}, so it follows that $O_C$ is open in $\overline{O_C}=X$.

Now suppose $O_C$ is an open $G_L$ orbit and let $D\in\matrices$. $O_D\subset X\setminus O_C$ and thus $\overline{O_D}\subset X\setminus O_C$. This shows $O_D$ is not open in $X$ and thus the claim is proven.}
\end{proof}

\subsection{Associativity of the generic product}

Given $A,B,C\in\matrices$ and $L\in\flags$ let
\begin{equation*}
X_{A,B,C}^L = \{L'''\in \flags:\exists (L',L'')\in\mathcal{O}_B \text{ with } (L,L')\in\mathcal{O}_A, (L'',L''')\in\mathcal{O}_C\}.
\end{equation*}

Note that $X_{A,B,C}^L\subset$ is contained in $\flags_{\co{C}}$ and is non-empty only if $L\in\flags_{\ro{A}}$, $\co{A}=\ro{B}$ and $\co{B}=\ro{C}$. $X_{A,B,C}^L$ consists of finitely many $G_L$-orbits. Using a similar argument to the existence of generic orbits we show that there is a unique generic orbit in $X_{A,B,C}^L$, which will establish associativity of the generic product. We now suppose $X_{A,B,C}^L$ is non-empty and fix $(L,L',L'',L''')\in\flags^4$ with $(L,L')\in\mathcal{O}_A$, $(L',L'')\in\mathcal{O}_B$ and $(L'',L''')\in\mathcal{O}_C$.

\begin{lemma}
$X_{A,B,C}^L$ is the image of the map
\begin{equation*}
\phi\colon G_L\times G_{L'}\times G_{L''}\to \flags: (\alpha,\beta,\gamma)\mapsto \alpha\beta\gamma L'''.
\end{equation*}
\end{lemma}

\begin{lemma}
{\color{red} Unsure with terminology here -- treat this with suspicion}
We may choose $N$ sufficiently large that
\begin{equation*}
H = \{g\in G: g=1 \text{ on } \epsilon^{-N}L_0/{\epsilon^N L_0}\}
\end{equation*}
is a normal subgroup in $G_L$, $G_{L'}$ and $G_{L''}$. Moreover, $N$ may be chosen so that the quotients $G_L/H$, $G_{L'}/H$ and $G_{L''}/H$ are algebraic groups, irreducible as varieties. In this case $G_L\times G_{L'}\times G_{L''}$ is an irreducible algebraic group.
\end{lemma}

\begin{proposition}
The closure $\overline{X_{A,B,C}^L}$ of $X_{A,B,C}^L$ in $\flags$ is irreducible.
\end{proposition}
\begin{proof}
{\color{red} assume chosen $N$ sufficiently large and $H=H_N$ so that $H$ is normal in each of the three stabilisers. Then the product of the quotient groups is an irreducible projective variety and thus the image under the orbit map has irreducible closure.}
\end{proof}

\begin{proposition}
There is a unique generic $G_L$-orbit in $X_{A,B,C}^L$.
\end{proposition}

\chapter{A realisation of affine zero Schur algebras}

We aim to prove the isomorphism theorem in the cases $r<n$ and $n\le r< 2n$ separately. Below are crude versions of the statements we want to prove.

\begin{theorem}
Assume $r<n$. The map $\psi\colon\generic\to\zeroschur$, given by $\psi(E_i)=E_i$, $\psi(F_i
)=F_i$ and $\psi(1_\lambda) = 1_\lambda$, is an isomorphism of $\integers$-algebras.
\end{theorem}
\begin{proof}{\color{gray}
Below are some of the pieces:
[1] The elements $E_i$, $F_i$, $1_\lambda$ generate $\generic$.

Provided $r<n$, any $A\in\matrices$ may be obtained from the diagonal matrix $D_\lambda$ with $\lambda=\ro{A}$ by a sequence of transitions $A \mapsto A\pm X_{i,p}$.

[2] Give a complete set of generating relations for $\generic$.}
\end{proof}

\begin{theorem}
Assume $n\le r< 2n$. There is a unique homomorphism of $\integers$-algebras $\hat{\psi}\colon\generic\to\zeroschur$ such that $\hat{\psi}(R)=R$ and $\hat{\psi}=\psi$ on the subalgebra of $\generic$ generated by the $E_i$, $F_i$ and $1_\lambda$. $\hat{\psi}$ is an isomorphism of $\integers$-algebras.
\end{theorem}

\section{Quivers with relations for the generic algebra.}

Recall that $\compositions$ denotes the set of compositions of $r$ into $n$ parts. That is, $\compositions$ is the set of tuples $\lambda = (\lambda_1,\ldots,\lambda_n)\in\integers^n$ with each $\lambda_i$ non-negative and $\lambda_1 +\cdots +\lambda_n = r$. Given $i\in [1,n]$, let $\epsilon_i = (0,\ldots,1,\ldots,0)\in\integers^n$ be the $i$--th elementary vector and let $\alpha_i = \epsilon_i - \epsilon_{i+1}$. Then given $\lambda\in\compositions$, we have $\lambda + \alpha_i\in\compositions$ provided $\lambda_{i+1}>0$ and $\lambda - \alpha_i\in\compositions$ provided $\lambda_i>0$.

%define the quiver:
Let $\Gamma =\presentationquiver$ be the quiver with set of vertices $\compositions$ with arrows $e_{i,\lambda}\colon\lambda\to\lambda +\alpha_i$ (if $\lambda_{i+1}>0$) and $f_{i,\lambda}\colon\lambda\to\lambda -\alpha_i$ (if $\lambda_i>0$). Thus there are no arrows between $\lambda$ and $\mu$ unless $\lambda = \mu\pm \alpha_i$ for some $i\in [1,n]$.

If $n\geq 3$ then neighbouring vertices are connected by two arrows, one of each direction. In the case $n=2$, neighbouring vertices are joined by four arrows, two of each direction. The $\integers\Gamma$ denote the path $\integers$ algebra of $\Gamma$. By construction of $\Gamma$, there is a $\integers$-algebra homomorphism $\integers\Gamma\to\generic$ with $e_{i,\lambda}\mapsto E_{i,\lambda}$, $f_{i,\lambda}\mapsto F_{i,\lambda}$ and $k_\lambda = 1_\lambda$. We aim to describe the image and kernel of the morphism to give a presentation of the generic algebra by a quiver with relations, when possible. In general, we should obtain a presentation of a subalgebra of the generic algebra consisting of the so-called aperiodic elements (c.f. \cite{lusztig99}).

% defining the set of aperiodic elements.

$A\in\matrices$ is said to be aperiodic if for each $l\in\integers\setminus\{0\}$ there exists $i\in\integers$ such that $a_{i,i+l}=0$. Denote the set of aperiodic elements in $\matrices$ by $\matrices^{ap}$. Note that $\matrices^{ap}=\matrices$ if $r<n$.


% image spanned by aperiodic elements. for all n.
\begin{proposition}
The subalgebra of $\generic$ generated by $E_{i,\lambda}$, $F_{i,\lambda}$ and $1_\lambda$ has $\integers$-basis $\{e_A:A\in\matrices^{ap}\}$, where $\matrices^{ap}\subset\matrices$ is the set of aperiodic elements.
\end{proposition}


% comment that all elements are aperiodic in the case r<n.

% Relations in the n>3 case

% Relations in the n=2 case.



\chapter{Further directions}

[1] Investigate link between this generic product and the generic extension of representations. Shifting to the non-negative subalgebra to do computations purely in terms of generic extensions of quiver representations.




\printbibliography

\end{document}
